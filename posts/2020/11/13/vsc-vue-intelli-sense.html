<!DOCTYPE HTML>
<html lang="zh-cmn-Hans" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>增强 Vue 项目的智能感知 - hamflx&#x27;s blog</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../../../../favicon.png">
        <link rel="stylesheet" href="../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../css/general.css">
        <link rel="stylesheet" href="../../../../css/chrome.css">
        <link rel="stylesheet" href="../../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../../highlight.css">
        <link rel="stylesheet" href="../../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../../css/custom.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../../index.html">个人学习分享</a></li><li class="chapter-item expanded affix "><li class="part-title">文章清单</li><li class="chapter-item expanded "><a href="../../../../posts/2023/2/28/call-net-from-rust-statically.html"><strong aria-hidden="true">1.</strong> 静态链接 C# 到 Rust</a></li><li class="chapter-item expanded "><a href="../../../../posts/2022/4/26/forward-dll.html"><strong aria-hidden="true">2.</strong> 使用 Rust 编写转发 DLL</a></li><li class="chapter-item expanded "><a href="../../../../posts/2021/11/23/vite-compatibility.html"><strong aria-hidden="true">3.</strong> vite 兼容性踩坑记录</a></li><li class="chapter-item expanded "><a href="../../../../posts/2021/10/14/fe-ffmpeg.html"><strong aria-hidden="true">4.</strong> 前端通过 ffmpeg 库播放视频</a></li><li class="chapter-item expanded "><a href="../../../../posts/2021/5/15/my-wordpress-config.html"><strong aria-hidden="true">5.</strong> 又一个 WordPress 博客的初始配置</a></li><li class="chapter-item expanded "><a href="../../../../posts/2021/1/24/element-memory-leak.html"><strong aria-hidden="true">6.</strong> 记一次内存泄漏的排查过程</a></li><li class="chapter-item expanded "><a href="../../../../posts/2020/11/13/vsc-vue-intelli-sense.html" class="active"><strong aria-hidden="true">7.</strong> 增强 Vue 项目的智能感知</a></li><li class="chapter-item expanded "><a href="../../../../posts/2020/11/13/vuedraggable-usage.html"><strong aria-hidden="true">8.</strong> vuedraggable 使用问题记录</a></li><li class="chapter-item expanded "><a href="../../../../posts/2019/3/22/dst-server.html"><strong aria-hidden="true">9.</strong> 玩饥荒联机版日志</a></li><li class="chapter-item expanded "><a href="../../../../posts/2023/2/11/fetch-browser.html"><strong aria-hidden="true">10.</strong> Chrome 时代的浏览器兼容性测试</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">hamflx&#x27;s blog</h1>

                    <div class="right-buttons">
                        <a href="../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="增强-vue-项目的智能感知"><a class="header" href="#增强-vue-项目的智能感知">增强 <code>Vue</code> 项目的智能感知</a></h1>
<p>本文说的类型支持仅仅是 <code>VS Code</code> 的 <code>IntelliSense</code> 功能，并非静态类型语言的类型检查，所以对开发的效率提升不大，但是可以提高项目的可维护性，即所谓代码即文档 <code>CaaD</code>（<code>Code as a Documentation</code> -_-）。</p>
<h2 id="vs-code-的-intellisense-功能"><a class="header" href="#vs-code-的-intellisense-功能"><code>VS Code</code> 的 <code>IntelliSense</code> 功能</a></h2>
<p>使用过 <code>IDE</code> 与静态类型语言的同学可能很熟悉了，比如 <code>VS</code>/<code>C#</code> 的自动导入命名空间、<code>Code Refactor</code>（重命名属性/方法/类名等标识符，并自动修改所有的引用）、转到定义（转到声明、查找引用）甚至代码段提取（提取一段代码作为一个函数，并自动将依赖的变量作为参数输入）等各种强大的功能。</p>
<p>而 <code>JS</code> 是一个动态类型的语言，为了支持上述功能，<code>VS Code</code> 团队开发了一个插件，名为 <code>Visual Studio IntelliCode</code>，最早该插件是作为一个外部扩展，后来直接作为内部扩展，可以直接使用。</p>
<p>以下摘自官网描述：</p>
<blockquote>
<p>IntelliSense is a general term for a variety of code editing features including: code completion, parameter info, quick info, and member lists. IntelliSense features are sometimes called by other names such as &quot;code completion&quot;, &quot;content assist&quot;, and &quot;code hinting.&quot;</p>
</blockquote>
<p>蹩脚翻译如下：</p>
<blockquote>
<p>智能感知是一系列编码特性的统称，包括自动补全、参数提示、快捷信息以及成员提示。……</p>
</blockquote>
<p><strong>特别注意</strong>：在成员提示被关闭的情况下可以使用快捷键 <code>Ctrl</code>+<code>Space</code> 重新打开成员提示（极大的可能与 <code>Windows</code> 系统默认的输入法切换键冲突导致失效，此时可以考虑更换快捷键），与 <code>Ctrl</code>+<code>Shift</code>+<code>Space</code> 打开参数提示。</p>
<h2 id="配置-jsconfigjson"><a class="header" href="#配置-jsconfigjson">配置 <code>jsconfig.json</code></a></h2>
<p>首先要说的是 <code>jsconfig.json</code> 文件。用 <code>vue</code> 脚手架生成的项目中，并无该文件，且一般情况下没有该文件也会有 <code>IntelliSense</code> 功能。</p>
<p>这里配置 <code>jsconfig.json</code> 的必要原因是：</p>
<ol>
<li>无该文件会导致项目内的 <code>.d.ts</code> 文件不一定被加载；</li>
<li>对于 <code>Vue</code> 项目来说，导入时使用 <code>@</code> 是很常见的行为，但是这将会导致 <code>IntelliSense</code> 无法识别。</li>
</ol>
<p>一个常见的 <code>jsconfig.json</code> 配置如下：</p>
<pre><code class="language-json">{
  &quot;compilerOptions&quot;: {
    &quot;baseUrl&quot;: &quot;.&quot;,
    &quot;paths&quot;: {
      &quot;@/*&quot;: [
        &quot;src/*&quot;
      ]
    }
  },
  &quot;include&quot;: [
    &quot;./src/**/*.d.ts&quot;,
    &quot;./src/**/*.js&quot;,
    &quot;./src/**/*.vue&quot;
  ]
}
</code></pre>
<p>这个 <code>jsconfig.json</code> 包含了对导入时 <code>@</code> 的解析以及扫描项目 <code>src</code> 目录及其子目录下的 <code>.d.ts</code>、<code>.js</code>、<code>.vue</code> 文件，以建立类型、引用等相关信息（转到定义、查找引用以及自动导入的关键）。</p>
<p>配置完成后重新加载（<code>Ctrl</code>+<code>Shift</code>+<code>P</code> 输入 <code>Reload Window</code> 并回车）即可。此时输入 <code>import '@/'</code> 后会有路径提示（如果没有可能是还没有加载完成，耐心等待一会儿 -.-）。</p>
<p><img src="./vsc-vue-intelli-sense/import-list.png" alt="导入提示" /></p>
<p>值得注意的是，导入 <code>SFC</code> 文件时，文件的路径必须添加 <code>.vue</code> 后缀：</p>
<pre><code class="language-javascript">import FieldEdit from '@/components/FieldEdit.vue'
</code></pre>
<p>这样的话你就可以将光标移动到组件名称上按下 <code>F12</code> 键以导航到组件的定义，否则是无法导航到组件定义的，你会看到这样的提示：</p>
<p><img src="./vsc-vue-intelli-sense/component-not-found.png" alt="导航失败" /></p>
<p>另外，配置完成后，还可以在 <code>&lt;template&gt;</code> 标签中得到自定义组件的补全提示，如果没有导入，甚至可以在敲回车补全时自动导入：</p>
<p><img src="./vsc-vue-intelli-sense/component-list.png" alt="导航失败" /></p>
<p>至于提示的组件的命名方式可以在此处配置，具体每个选项都有描述就不说了：</p>
<p><img src="./vsc-vue-intelli-sense/tag-casing.png" alt="规则配置" /></p>
<h2 id="jsdoc-注释"><a class="header" href="#jsdoc-注释"><code>JSDoc</code> 注释</a></h2>
<p>即使用注释来说明代码。在 <code>VS Code</code> 中可以通过在 <code>js</code> 类型的文件中输入 <code>/**</code> 来触发 <code>JSDoc</code> 代码片段，以下是一些实例：</p>
<pre><code class="language-javascript">/**
 * 引用数据额外的信息发生了变化的事件。
 */
const EVENT_ISSUE_INFO_CHANGE = 'issue-info-change'

/**
 * 所属的应用类型 ID。
 */
const ISSUE_TYPE = {
  /** 需求。 */
  REQUIREMENT: 1,
  /** 任务。 */
  TASK: 2
}

/**
 * 将一个字符串反过来。
 * @param {string} str 需要反转的字符串。
 * @returns {string} 反转后的字符串。
 */
function reverseString (str) {
  return str.split('').reverse().join('')
}
</code></pre>
<p>这种注释可以提供如下的效果，在成员提示的列表中可以显示注释内容，即做到文档的效果（同时鼠标悬浮时也会有文档的提示）：</p>
<p><img src="./vsc-vue-intelli-sense/member-list.png" alt="成员提示" /></p>
<p><img src="./vsc-vue-intelli-sense/function-annote.png" alt="函数声明" /></p>
<p>可以看到，第二张图标注了传入参数 <code>str</code> 的类型，在输入 <code>str.sp</code> 时会给予成员提示，敲回车键后即会自动完成。</p>
<h2 id="类型声明文件"><a class="header" href="#类型声明文件">类型声明文件</a></h2>
<p>类型声明文件是一个 <code>.d.ts</code> 文件，使用过 <code>Type Script</code> 的同学应该不陌生，在使用 <code>Type Script</code> 开发库项目时，如果需要发布到 <code>npm</code> 仓库，则需要编译成 <code>js</code> 发布，并可以用 <code>tsc</code> 生成对应的类型声明文件，以供使用者参照。</p>
<p>对于没有 <code>Type Script</code> 的 <code>Vue</code> 项目，仍然可以使用 <code>.d.ts</code> 文件带来的部分便利，虽然需要手写 <code>.d.ts</code> 文件。</p>
<p>一个 <code>.d.ts</code> 文件的例子如下：</p>
<pre><code class="language-typescript">/**
 * 应用数据的模型。
 */
declare type IssueModel = {
  /**
   * 应用数据的属性字典。
   */
  dataMap: {
    [key in IssuePropertyNames]: IssueProperty
  }

  /**
   * 可编辑的属性名称列表。
   */
  editablePropertyList: string[]
}

/**
 * 应用数据的数据属性名称列表。
 */
declare type IssuePropertyNames =
  'id' |
  'issuetype' |
  'key' |
  'project' |
  'summary' |
  'description'

/**
 * 应用数据的属性定义。
 */
declare interface IssueProperty {
  /**
   * 属性的名称。
   */
  name: string

  /**
   * 属性值的可读形式。
   */
  label: string

  /**
   * 属性值。
   */
  value: PropertyValue
}

/**
 * 属性值的类型。
 */
declare type PropertyValue = boolean | number | string | boolean[] | number[] | string[]
</code></pre>
<p>上述代码并不会生成 <code>js</code> 代码，仅仅在开发期间被编辑器或集成开发环境识别以用作代码自动完成、成员提示等功能。在数据结构较为复杂时，可以利用类型声明文件作为文档以提高项目的可维护性。</p>
<p>虽然类型声明文件不参与 <code>js</code> 代码的执行，但是仍然可以利用类型声明文件影响到 <code>js</code> 代码的编写，将上述类型声明文件保存后，即可在 <code>js</code> 代码中以 <code>JSDoc</code> 的形式引用：</p>
<pre><code class="language-javascript">/**
 * 应用数据模型。
 * @type {IssueModel}
 */
const model = {
  dataMap: {
    issuetype: {
      value: ISSUE_TYPE.REQUIREMENT
    }
  }
}

console.log(model.dataMap.issuetype.value)
</code></pre>
<p>效果如下：</p>
<p><img src="./vsc-vue-intelli-sense/object-definition-member-list.png" alt="对象成员" /></p>
<p><img src="./vsc-vue-intelli-sense/object-ref-member-list.png" alt="对象成员" /></p>
<h2 id="sfc-的成员类型"><a class="header" href="#sfc-的成员类型"><code>SFC</code> 的成员类型</a></h2>
<pre><code class="language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;input v-model=&quot;value&quot; @blur=&quot;handleInputBlur&quot; /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  props: {
    /**
     * 应用数据模型。
     * @type {import('vue').PropOptions&lt;IssueModel&gt;}
     */
    model: {
      type: Object,
      required: true
    },
    /**
     * 需要编辑的字段。
     * @type {import('vue').PropOptions&lt;IssuePropertyNames&gt;}
     */
    property: {
      type: String,
      required: true
    }
  },
  data () {
    return {
      value: this.model.dataMap[this.property].value,
      /**
       * @type {IssueModel}
       */
      other: {}
    }
  },
  methods: {
    /**
     * 获取属性值。
     * @param {IssueModel} issue 应用数据模型。
     * @param {IssuePropertyNames} property 属性名称。
     * @returns {PropertyValue} 属性值。
     */
    getPropertyValue (issue, property) {
      issue.dataMap[property].value
    },
    handleInputBlur () {
      this.$emit('submit', this.model, this.property, this.value)
    }
  }
}
&lt;/script&gt;
</code></pre>
<p>上面分别标记了 <code>props</code>、<code>data</code>、<code>methods</code> 的数据类型、参数及返回值，在引用这些属性、变量时，将会有自动完成提示、参数信息等：</p>
<p><img src="./vsc-vue-intelli-sense/vue-member-list.png" alt="对象成员" /></p>
<p><img src="./vsc-vue-intelli-sense/vue-method-param.png" alt="对象成员" /></p>
<h2 id="自动导入功能"><a class="header" href="#自动导入功能">自动导入功能</a></h2>
<p>在引用一些常用的导出符号时，如果这个符号没有被导入，则可以在打开的成员提示中找到这个标识符，并键入回车完成自动补全，这个时候会自动导入这个标识符：</p>
<p><img src="./vsc-vue-intelli-sense/auto-import.png" alt="对象成员" /></p>
<p>在提示信息中说明了 <code>Import 'ISSUE_TYPE' from module &quot;@/constatns/issueType&quot;</code>，键入回车即可自动导入该标识符。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../../posts/2021/1/24/element-memory-leak.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../../../posts/2020/11/13/vuedraggable-usage.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
                <script>
                
                    document.body.querySelector('main').insertAdjacentHTML('beforeend', `
                        <div id="disqus_thread"></div>
                    `);
                    /**
                    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
                
                    var disqus_config = function () {
                    this.page.url = undefined;  // Replace PAGE_URL with your page's canonical URL variable
                    this.page.identifier = 'posts/2020/11/13/vsc-vue-intelli-sense.md'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                    };
                
                    (function() { // DON'T EDIT BELOW THIS LINE
                    var d = document, s = d.createElement('script');
                    s.src = 'https://hamflx-blog.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                
                <!-- Global site tag (gtag.js) - Google Analytics -->
                <script async src="https://www.googletagmanager.com/gtag/js?id=G-8V723V89LY"></script>
                <script>
                  window.dataLayer = window.dataLayer || [];
                  function gtag(){dataLayer.push(arguments);}
                  gtag('js', new Date());
                
                  gtag('config', 'G-8V723V89LY');
                </script>
                
                <div class="icp">
                  <a class="icp-link" href="https://beian.miit.gov.cn/" target="_blank">皖ICP备16015010号-2</a>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../../posts/2021/1/24/element-memory-leak.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../../../posts/2020/11/13/vuedraggable-usage.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../../elasticlunr.min.js"></script>
        <script src="../../../../mark.min.js"></script>
        <script src="../../../../searcher.js"></script>

        <script src="../../../../clipboard.min.js"></script>
        <script src="../../../../highlight.js"></script>
        <script src="../../../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
